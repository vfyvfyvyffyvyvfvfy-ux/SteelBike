# Пошаговое добавление/редактирование тарифа

## Описание
Реализован пошаговый процесс создания и редактирования тарифов в том же стиле, что и приемка велосипедов.

## Как это работает

### Открытие модального окна
- Кнопка "Добавить тариф" открывает модальное окно для создания нового тарифа
- Кнопка "Ред." в таблице тарифов открывает модальное окно для редактирования существующего

### Шаг 1: Основная информация
Администратор вводит базовые данные:
- **Название тарифа** (обязательно) - например: "Электроскутеры U2"
- **Краткое описание** - текст для карточки тарифа, который видят клиенты

### Шаг 2: Описания
Администратор вводит полное описание:
- **Описание для договора** - юридическое описание, которое будет вставлено в договор аренды

### Шаг 3: Стоимость и длительность
Администратор настраивает периоды аренды:
- Первая строка - основной период аренды
- Можно добавить несколько продлений
- Для каждого периода указывается:
  - Количество дней
  - Стоимость в рублях
- Кнопка "+ Добавить продление" для добавления новых периодов
- Кнопка "×" для удаления периода (минимум один должен остаться)

### Шаг 4: Настройки
Администратор выбирает дополнительные параметры:
- **Шаблон договора** - выбор из списка доступных шаблонов
- **Тариф активен** - чекбокс, только активные тарифы видны клиентам

## Визуальный стиль

### Индикатор прогресса
- 4 шага с кружками (1-2-3-4)
- Активный шаг подсвечен зеленым
- Пройденные шаги отмечены галочкой
- Цвета из палитры приложения (без кислотных оттенков)

### Карточки периодов аренды
- Светлый фон (var(--card-bg))
- Поля ввода для дней и цены
- Кнопка удаления справа

### Навигация
- Кнопка "← Назад" (скрыта на первом шаге)
- Кнопка "Далее →" (скрыта на последнем шаге)
- Кнопка "Сохранить тариф" (видна только на последнем шаге)

## Валидация

### Шаг 1
- Проверка наличия названия тарифа

### Шаг 3
- Проверка заполнения всех полей (дни и цена)
- Минимум один период аренды

## Технические детали

### Файлы
- `site/admin.html` - HTML разметка модального окна
- `site/admin.js` - JavaScript логика пошагового процесса
- `site/admin.css` - Стили для карточек периодов и чекбоксов

### HTML структура
```html
<div id="tariff-modal" class="overlay hidden">
  <div class="modal">
    <div class="modal-header">
      <h3 id="tariff-modal-title">Новый тариф</h3>
      <button id="tariff-modal-close-btn" class="close-btn">&times;</button>
    </div>
    <div class="modal-body">
      <!-- Индикатор шагов -->
      <!-- Шаг 1: Основная информация -->
      <!-- Шаг 2: Описания -->
      <!-- Шаг 3: Стоимость и длительность -->
      <!-- Шаг 4: Настройки -->
    </div>
    <div class="modal-footer">
      <button id="tariff-prev-btn">← Назад</button>
      <button id="tariff-next-btn">Далее →</button>
      <button id="tariff-save-btn">Сохранить тариф</button>
    </div>
  </div>
</div>
```

### JavaScript функции
- `showTariffStep(step)` - показать конкретный шаг
- `updateTariffStepIndicators()` - обновить индикаторы прогресса
- `resetTariffModal()` - сбросить модальное окно к начальному состоянию
- `addExtensionRow(days, price)` - добавить строку периода аренды
- `window.editTariffModal(id)` - открыть модальное окно для редактирования

### CSS классы
- `.tariff-step` - контейнер для шага
- `.extensions-list` - список периодов аренды
- `.extension-item` - карточка одного периода
- `.checkbox-label` - стилизованный чекбокс

### Сохранение данных
При нажатии "Сохранить тариф":
1. Собираются данные из всех полей
2. Формируется массив extensions с периодами аренды
3. Данные отправляются в Supabase (insert или update)
4. Обновляется таблица тарифов
5. Модальное окно закрывается

## Преимущества

1. **Логичная структура** - информация разбита на логические блоки
2. **Меньше ошибок** - валидация на каждом шаге
3. **Удобство** - не нужно скроллить длинную форму
4. **Визуальный прогресс** - всегда видно на каком шаге находишься
5. **Гибкость** - можно вернуться назад для исправления
6. **Единый стиль** - соответствует дизайну приложения

## Использование

### Создание нового тарифа
1. Перейдите в раздел "Тарифы"
2. Нажмите "Добавить тариф"
3. Пройдите все 4 шага, заполняя информацию
4. Нажмите "Сохранить тариф"

### Редактирование тарифа
1. В таблице тарифов найдите нужный тариф
2. Нажмите кнопку "Ред."
3. Измените необходимые данные
4. Нажмите "Сохранить тариф"

## Примечания

- Старая форма тарифа удалена из интерфейса
- Все операции теперь выполняются через модальное окно
- Можно добавить неограниченное количество периодов аренды
- Минимум один период аренды обязателен
- Только активные тарифы видны клиентам в приложении
