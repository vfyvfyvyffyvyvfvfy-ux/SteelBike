# üèóÔ∏è –ù–æ–≤–∞—è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Bike App - –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

## üéØ –ü—Ä–æ–±–ª–µ–º–∞, –∫–æ—Ç–æ—Ä—É—é –º—ã —Ä–µ—à–∏–ª–∏

**–°—Ç–∞—Ä–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏–º–µ–ª–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:**

1. **–¢–∞–π–º-–∞—É—Ç—ã Vercel** - –ë–µ—Å—Å–µ—Ä–≤–µ—Ä–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–º–µ—é—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ 10-60 —Å–µ–∫—É–Ω–¥
2. **–ü–ª–æ—Ö–æ–π UX** - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∂–¥–∞–ª OCR –≤–æ –≤—Ä–µ–º—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
3. **–ù–µ–Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - –ü—Ä–∏ —Å–±–æ–µ OCR —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –º–æ–≥–ª–∞ –ø—Ä–æ–≤–∞–ª–∏—Ç—å—Å—è
4. **–ú–æ–Ω–æ–ª–∏—Ç–Ω–æ—Å—Ç—å** - –û–¥–∏–Ω —Å–µ—Ä–≤–∏—Å –¥–µ–ª–∞–ª –≤—Å—ë

## üöÄ –ù–æ–≤–∞—è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ - –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã

### **–û—Å–Ω–æ–≤–Ω–æ–π API (Vercel) - –ë—ã—Å—Ç—Ä—ã–π –∏ –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Telegram      ‚îÇ
‚îÇ   Web App       ‚îÇ
‚îÇ                 ‚îÇ
‚îÇ  –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è    ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ –ë—ã—Å—Ç—Ä—ã–π –æ—Ç–≤–µ—Ç (1-2 —Å–µ–∫)
‚îÇ  –í–∞–ª–∏–¥–∞—Ü–∏—è      ‚îÇ
‚îÇ  –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚îÇ Fire & Forget
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   OCR Worker    ‚îÇ
‚îÇ   (Render)      ‚îÇ
‚îÇ                 ‚îÇ
‚îÇ  –°–∫–∞—á–∏–≤–∞–Ω–∏–µ     ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
‚îÇ  OCR Gemini     ‚îÇ
‚îÇ  –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã:**

#### 1. **Frontend (Telegram Web App)**
- ‚úÖ –ë—ã—Å—Ç—Ä–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
- ‚úÖ Telegram file upload

#### 2. **–û—Å–Ω–æ–≤–Ω–æ–π API (Vercel)**
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (1-2 —Å–µ–∫)
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Supabase
- ‚úÖ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –≤—ã–∑–æ–≤ OCR –≤–æ—Ä–∫–µ—Ä–∞
- ‚úÖ –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

#### 3. **OCR Worker (Render)**
- ‚úÖ –§–æ–Ω–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- ‚úÖ –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏–∑ Telegram
- ‚úÖ OCR —á–µ—Ä–µ–∑ Google Gemini
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä

| –ê—Å–ø–µ–∫—Ç | –°—Ç–∞—Ä–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ | –ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ |
|--------|-------------------|-------------------|
| **–í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞** | 30-120 —Å–µ–∫ | 1-2 —Å–µ–∫ |
| **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** | –ù–∏–∑–∫–∞—è (—Ç–∞–π–º-–∞—É—Ç—ã) | –í—ã—Å–æ–∫–∞—è (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è) |
| **UX** | –ü–ª–æ—Ö–æ–π (–¥–æ–ª–≥–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ) | –û—Ç–ª–∏—á–Ω—ã–π (–º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π) |
| **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** | –ù–∏–∑–∫–∞—è | –í—ã—Å–æ–∫–∞—è |
| **–°—Ç–æ–∏–º–æ—Å—Ç—å** | –í—ã—Å–æ–∫–∞—è (–¥–æ–ª–≥–∏–µ –∑–∞–ø—Ä–æ—Å—ã) | –ù–∏–∑–∫–∞—è (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ) |

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**
–î–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è, –≤—Å—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –±—ã–ª–∞ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞. –ö–ª–∏–µ–Ω—Ç—Å–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (frontend) –±–æ–ª—å—à–µ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.

- **Frontend**: –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ, frontend –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø—É–±–ª–∏—á–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (–∏–º—è –±–æ—Ç–∞, —Å—Å—ã–ª–∫–∏ –∏ —Ç.–¥.) —Å —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ `/api/config`.
- **Backend**: –í—Å–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏, —Ç–æ–∫–µ–Ω—ã –∏ URL-–∞–¥—Ä–µ—Å–∞ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–æ–≤—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö (Vercel, Render).
- **`.env.example`**: –í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ñ–∞–π–ª `.env.example`, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –ø–æ–ª–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã.

### **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**

#### –û—Å–Ω–æ–≤–Ω–æ–π API (Vercel):
```
SUPABASE_URL=...
SUPABASE_SERVICE_ROLE_KEY=...
TELEGRAM_BOT_TOKEN=...
OCR_WORKER_URL=https://your-ocr-worker.onrender.com
INTERNAL_SECRET=your_secret_key
```

#### OCR Worker (Render):
```
SUPABASE_URL=...
SUPABASE_ANON_KEY=...
TELEGRAM_BOT_TOKEN=...
GEMINI_API_KEY=...
INTERNAL_SECRET=your_secret_key
```

### **–°—Ç–∞—Ç—É—Å—ã –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏**

```sql
-- –ù–æ–≤—ã–µ —Å—Ç–∞—Ç—É—Å—ã –≤ —Ç–∞–±–ª–∏—Ü–µ clients
verification_status:
  - 'approved'        -- –ë–µ–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
  - 'pending_ocr'     -- –û–∂–∏–¥–∞–µ—Ç OCR
  - 'processing_ocr'  -- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è
  - 'ocr_complete'    -- OCR –∑–∞–≤–µ—Ä—à–µ–Ω
  - 'ocr_failed'      -- –û—à–∏–±–∫–∞ OCR
  - 'needs_confirmation' -- –¢—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º
```

### **API Endpoints**

#### POST /api/telegram-register
```json
// –ó–∞–ø—Ä–æ—Å
{
  "initData": "telegram_init_data",
  "formData": {
    "name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
    "phone": "+7...",
    "file_ids": [{"field": "passport", "file_id": "..."}]
  }
}

// –û—Ç–≤–µ—Ç (–±—ã—Å—Ç—Ä—ã–π)
{
  "success": true,
  "message": "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–∏–Ω—è—Ç–∞. –î–æ–∫—É–º–µ–Ω—Ç—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è.",
  "client": {...}
}
```

#### POST /ocr-worker/process-document
```json
// –ó–∞–ø—Ä–æ—Å (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π)
{
  "userId": "uuid",
  "fileIds": [{"field": "passport", "file_id": "..."}]
}

// –û—Ç–≤–µ—Ç
{
  "success": true,
  "documentType": "–ø–∞—Å–ø–æ—Ä—Ç_—Ä—Ñ"
}
```

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### 1. **OCR Worker –Ω–∞ Render**

```bash
cd ocr-worker
npm install
# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å .env
# –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –Ω–∞ Render —á–µ—Ä–µ–∑ GitHub
```

### 2. **–û—Å–Ω–æ–≤–Ω–æ–π API –Ω–∞ Vercel**

```bash
# –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
OCR_WORKER_URL=https://your-worker.onrender.com
INTERNAL_SECRET=your_secret
```

## üìà –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### **–î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
- ‚ö° **–ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è** - –Ω–µ—Ç –æ–∂–∏–¥–∞–Ω–∏—è
- üéØ **–õ—É—á—à–∏–π UX** - —á–µ—Ç–∫–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
- üì± **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –ø—Ä–∏ —Å–±–æ—è—Ö OCR

### **–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:**
- üîß **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- üõ†Ô∏è **–û–±—Å–ª—É–∂–∏–≤–∞–µ–º–æ—Å—Ç—å** - —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- üí∞ **–≠–∫–æ–Ω–æ–º–∏—á–Ω–æ—Å—Ç—å** - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã
- üß™ **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å** - –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### **–î–ª—è –±–∏–∑–Ω–µ—Å–∞:**
- üìä **–ú–µ—Ç—Ä–∏–∫–∏** - —Ç–æ—á–Ω–æ–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
- üîÑ **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å** - graceful degradation
- üìà **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –±—ã—Å—Ç—Ä—ã–µ –æ—Ç–≤–µ—Ç—ã API

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏** —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∞—è –æ—Ç–ª–∏—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç –∏ –≤—ã—Å–æ–∫—É—é –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å!

---

*–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –æ—Ç–ª–∏—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –æ–ø—ã—Ç–∞.*