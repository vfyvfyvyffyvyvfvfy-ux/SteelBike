<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PRIZMATIC • Запуск</title>
  <meta http-equiv="refresh" content="2;url=index.html">
  <style>
    html,body{height:100%}
    body{margin:0;display:flex;align-items:center;justify-content:center;font:500 16px/1.4 Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:#083830;background:#e0f8f1}
    .wrap{background:#fff;border-radius:16px;padding:20px 24px;box-shadow:0 8px 40px rgba(0,0,0,.08);text-align:center}
  </style>
    <script src="transitions.js" defer></script>
</head>
<body>
  <div class="wrap">
    Открываем PRIZMATIC… Если не случилось, <a id="fallback" href="index.html">нажмите сюда</a>.
  </div>
  <script>
    (function(){
      var tg = (window.Telegram && window.Telegram.WebApp) ? window.Telegram.WebApp : null;
      try { if (tg && tg.ready) tg.ready(); } catch(_){}

      // Куда редиректить: можно передать ?to=/map.html или ?to=stats.html
      var params = new URLSearchParams(location.search);
      var to = params.get('to') || 'index.html';
      if(!/^(https?:)?\/\//i.test(to)) {
        // нормализуем относительный путь
        to = new URL(to, location.href).pathname;
      }

      // Помечаем сессию как Telegram WebApp
      try {
        sessionStorage.setItem('tgWebApp','1');
        if (tg && tg.platform) sessionStorage.setItem('tgWebAppPlatform', tg.platform);
      } catch(_){}

      // Добавляем параметр для явной индикации
      var target = new URL(to, location.href);
      target.searchParams.set('tgWebApp','1');
      if (tg && tg.platform) target.searchParams.set('tgWebAppPlatform', tg.platform);

      document.getElementById('fallback').href = target.toString();
      // Мгновенный редирект без записи в историю
      location.replace(target.toString());
    })();
  </script>
</body>
</html>
